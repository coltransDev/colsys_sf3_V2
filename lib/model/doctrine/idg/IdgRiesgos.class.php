<?php

/**
 * IdgRiesgos
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    symfony
 * @subpackage model
 * @author     Your name here
 * @version    SVN: $Id: Builder.php 6820 2009-11-30 17:27:49Z jwage $
 */
class IdgRiesgos extends BaseIdgRiesgos
{
    
    /*
     * Retorna el objeto Causas ordenado por fecha de creación
     * @author: Andrea Ramírez
     */

    public function getIdgCausas() {
        
        return Doctrine::getTable("IdgCausas")
                ->createQuery("r")
                ->select("r.*")                
                ->where("r.ca_idriesgo = ? ", $this->getCaIdriesgo())
                ->orderBy("r.ca_fchcreado ASC")
                ->execute();
    }
    
    /*
     * Retorna la última valoración de cada riesgo
     * @author: Andrea Ramírez
     */

    public function getUltimaValoracion() {
        
        return Doctrine::getTable("IdgValoracion")
                ->createQuery("r")
                ->select("r.*")                
                ->where("r.ca_idriesgo = ? ", $this->getCaIdriesgo())
                ->orderBy("r.ca_fchcreado DESC")
                ->fetchOne();
    }
}
