<?php

/**
 * TrackingEtapa
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    ##PACKAGE##
 * @subpackage ##SUBPACKAGE##
 * @author     ##NAME## <##EMAIL##>
 * @version    SVN: $Id: Builder.php 5845 2009-06-09 07:36:57Z jwage $
 */
class TrackingEtapa extends BaseTrackingEtapa
{
    public function getIntroAsunto(){
        if($this->getCaPreasunto()!="")
        {
            $asunto=$this->getCaPreasunto()." ";
        }
        else
        {
            if( $this->getCaDepartamento()=="OTM/DTA" ){
                $asunto = "Status OTM";
            }else{
                $asunto = "Status";
            }
        }		
		return $asunto;
	}
    
    public function getPerfilxTipo($tipo)
    {
        $r_perfiles = array();
        $perfiles = Doctrine::getTable("TrackingPerfil")
                            ->createQuery("t")
                            ->select("t.ca_perfil")
                            ->where("t.ca_idetapa = ? AND t.ca_tipo = ?  ", array($this->getCaIdetapa(), $tipo))
                            ->execute();
        foreach($perfiles as $p)
        {
            $r_perfiles[]=$p->getCaPerfil();
        }
        return $r_perfiles;        
    }
}

