<?php

/**
 * InoTransaccion
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    ##PACKAGE##
 * @subpackage ##SUBPACKAGE##
 * @author     ##NAME## <##EMAIL##>
 * @version    SVN: $Id: Builder.php 6508 2009-10-14 06:28:49Z jwage $
 */
class InoTransaccion extends BaseInoTransaccion
{
    private $parametro = null;

    public function getInoParametroFacturacion(){
        if( !$this->parametro ){
            $this->parametro = Doctrine::getTable("InoParametroFacturacion")
                                   ->createQuery("p")
                                   ->select("p.*")
                                   ->where("p.ca_idconcepto = ? AND p.ca_idccosto = ?", array($this->getCaIdconcepto(), $this->getCaIdccosto()) )
                                   ->fetchOne();
            
        }
        return $this->parametro;
    }

    public function getInoParametroCosto(){
        if( !$this->parametro ){
            $this->parametro = Doctrine::getTable("InoParametroCosto")
                                   ->createQuery("p")
                                   ->select("p.*")
                                   ->where("p.ca_idconcepto = ? AND p.ca_idccosto = ?", array($this->getCaIdconcepto(), $this->getCaIdccosto()) )
                                   ->fetchOne();

        }
        return $this->parametro;
    }



    public function getImpuestos(){
        $impuestos = array();
        $parametro = $this->getInoParametroFacturacion();
        if( $parametro->getCaIva() ){
            if( $this->getCaDb() ){
                $impuestos["iva"]["db"] = $this->getCaValor()*$parametro->getCaIva();
                $impuestos["iva"]["cr"] = 0;
            }else{
                $impuestos["iva"]["db"] = 0;
                $impuestos["iva"]["cr"] = $this->getCaValor()*$parametro->getCaIva();
            }
        }else{
            $impuestos["iva"]["db"] = 0;
            $impuestos["iva"]["cr"] = 0;
        }
        return $impuestos;
    }
}