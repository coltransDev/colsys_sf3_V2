<?php

/**
 * TrackingUser
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    ##PACKAGE##
 * @subpackage ##SUBPACKAGE##
 * @author     ##NAME## <##EMAIL##>
 * @version    SVN: $Id: Builder.php 5845 2009-06-09 07:36:57Z jwage $
 */
class TrackingUser extends BaseTrackingUser
{
    /*
	* Guarda la clave del usuario, a partir del codigo de activacion para evitar
	* que dos columnas tengan el mismo  hash a pesar de que tengan la misma clave
	*/
	public function setPasswd( $aPasswd ){
		if( $this->getCaActivationCode() ){
			$passwd = sha1( $this->getCaActivationCode().$aPasswd );
			$this->setCaPasswd( $passwd );
		}
	}

	/*
	* Genera un codigo de activacion
	*/
	public function generateActivationCode(){
		$string = $this->getCaEmail().date("Y-m-d h:i:s").rand(1000 , 10000);
		$code = sha1( $string );
		$this->setCaActivationCode( $code );
		return $code;
	}

	/*
	* Verifica que el password sea valido
	*/
	public function checkPasswd( $sValue ){
		$passwd = sha1($this->getCaActivationCode().$sValue);
		if( $passwd == $this->getCaPasswd() && !$this->getCaBlocked()){
			return true;
		}
		return false;
	}
}