<?xml version="1.0" encoding="UTF-8"?>
<database name="propel" defaultIdMethod="native" noxsd="true" package="lib.model.control">
	
	<table name="control.tb_usuarios" phpName="Usuario">
		<column name="ca_login" type="varchar" required="true" primaryKey="true"  />			
		<column name="ca_nombre" type="varchar" />		
		<column name="ca_cargo" type="varchar" size="10" />	
		<column name="ca_departamento" type="varchar" />
		<column name="ca_idsucursal" type="varchar" />						
		<column name="ca_email" type="varchar" />
		<column name="ca_rutinas" type="varchar" />
		<column name="ca_extension" type="varchar" />	
		<column name="ca_authmethod" type="varchar" />	
		<column name="ca_passwd" type="varchar" />	
		<column name="ca_salt" type="varchar" />	
		<column name="ca_activo" type="boolean" />	
		<column name="ca_forcechange" type="boolean" />	
		<column name="ca_sucursal" type="varchar" />	
		
		<foreign-key foreignTable="control.tb_sucursales">
			<reference local="ca_idsucursal" foreign="ca_idsucursal"/>
		</foreign-key>		
	</table>
	
	<table name="control.tb_niveles" phpName="NivelesAcceso">
		<column name="ca_login" type="varchar" required="true" primaryKey="true"  />			
		<column name="ca_basededatos" type="varchar" primaryKey="true" />				
		<column name="ca_nivel" type="varchar" />	
		<foreign-key foreignTable="control.tb_usuarios">
			<reference local="ca_login" foreign="ca_login"/>
		</foreign-key>			
	</table>
	
	<table name="control.tb_sucursales" phpName="Sucursal">
		<column name="ca_idsucursal" type="VARCHAR" size="3"  primaryKey="true"/>
		<column name="ca_nombre" type="VARCHAR" size="50" required="true"/>
		<column name="ca_telefono" type="VARCHAR" size="50"/>
		<column name="ca_fax" type="VARCHAR" size="100"/>
		<column name="ca_direccion" type="VARCHAR" size="100"/>
	</table>
	
	<table name="control.tb_log" phpName="LogUsuario">
		<column name="ca_idlog" type="integer" required="true" primaryKey="true"/>
		<column name="ca_login" type="VARCHAR" size="50"/>
		<column name="ca_event" type="VARCHAR" />
		<column name="ca_module" type="VARCHAR" size="100"/>
		<column name="ca_action" type="VARCHAR" size="100"/>
	</table>
	
	<table name="control.tb_accesos_grp" phpName="AccesoGrupo">
		
		<column name="ca_rutina" type="VARCHAR"  primaryKey="true"/>
		<column name="ca_grupo" type="VARCHAR"  primaryKey="true"/>
		<column name="ca_acceso" type="integer" />
		
	</table>
	
	<table name="control.tb_accesos_user" phpName="AccesoUsuario">		
		<column name="ca_rutina" type="VARCHAR"  primaryKey="true" />
		<column name="ca_login" type="VARCHAR"  primaryKey="true"/>
		<column name="ca_acceso" type="integer" />	
		<foreign-key foreignTable="control.tb_usuarios">
			<reference local="ca_login" foreign="ca_login"/>
		</foreign-key>			
	</table>
	
	<table name="control.tb_rutinas" phpName="Rutina">
		<column name="ca_rutina" type="VARCHAR" required="VARCHAR" primaryKey="true"/>
		<column name="ca_opcion" type="VARCHAR" />
		<column name="ca_descripcion" type="VARCHAR" />
		<column name="ca_programa" type="VARCHAR" />
		<column name="ca_grupo" type="VARCHAR" />		
	</table>
	
	
	<table name="control.tb_rutinas_old" phpName="RutinaOld">
		<column name="ca_rutina" type="VARCHAR" required="VARCHAR" primaryKey="true"/>
		<column name="ca_opcion" type="VARCHAR" />
		<column name="ca_descripcion" type="VARCHAR" />
		<column name="ca_programa" type="VARCHAR" />
		<column name="ca_grupo" type="VARCHAR" />		
	</table>
	
	<table name="control.tb_departamentos" phpName="Departamento">
		<column name="ca_iddepartamento" type="integer" required="true" primaryKey="true" autoIncrement="true" />
		<id-method-parameter value="control.tb_departamentos_id"/>			
		<column name="ca_nombre" type="varchar" />			
		<column name="ca_inhelpdesk" type="boolean" />	
	</table>
		
	<table name="control.tb_grupos" phpName="Grupo">				
		<column name="ca_nombre" type="varchar" primaryKey="true"/>					
	</table>
	
	<table name="control.tb_usuarios_grupo" phpName="UsuarioGrupo">				
		<column name="ca_login" type="varchar" primaryKey="true"/>	
		<column name="ca_grupo" type="varchar" primaryKey="true"/>				
	</table>
	
	
	<table name="control.tb_perfiles" phpName="Perfil">				
		<column name="ca_perfil" type="varchar" primaryKey="true"/>	
		<column name="ca_nombre" type="varchar" />	
		<column name="ca_descripcion" type="varchar" />	
		<column name="ca_departamento" type="varchar" />
		
		<foreign-key foreignTable="control.tb_departamentos">
			<reference local="ca_departamento" foreign="ca_nombre"/>
		</foreign-key>						
	</table>
	
	
	<table name="control.tb_accesos_perfiles" phpName="AccesoPerfil">				
		<column name="ca_rutina" type="varchar" primaryKey="true"/>	
		<column name="ca_perfil" type="varchar" primaryKey="true"/>			
		<column name="ca_acceso" type="integer" />	
		<foreign-key foreignTable="control.tb_perfiles">
			<reference local="ca_perfil" foreign="ca_perfil"/>
		</foreign-key>				
	</table>
	
	<table name="control.tb_usuarios_perfil" phpName="UsuarioPerfil">				
		<column name="ca_login" type="varchar" primaryKey="true"/>	
		<column name="ca_perfil" type="varchar" primaryKey="true"/>		
		<foreign-key foreignTable="control.tb_usuarios">
			<reference local="ca_login" foreign="ca_login"/>
		</foreign-key>	
		<foreign-key foreignTable="control.tb_perfiles">
			<reference local="ca_perfil" foreign="ca_perfil"/>
		</foreign-key>			
	</table>
	
	
	<table name="control.tb_rutinas_niveles" phpName="RutinaNivel">				
		<column name="ca_rutina" type="varchar" primaryKey="true"/>	
		<column name="ca_nivel" type="varchar" primaryKey="true"/>		
		<column name="ca_valor" type="varchar" />
		<foreign-key foreignTable="control.tb_rutinas">
			<reference local="ca_rutina" foreign="ca_rutina"/>
		</foreign-key>	
			
	</table>
	
	<table name="control.tb_usuarios_log" phpName="UsuarioLog">
		<id-method-parameter value="control.tb_usuarios_log_id"/>
		<column name="ca_id" type="integer" required="true" primaryKey="true" autoIncrement="true" />			
		<column name="ca_login" type="varchar" />	
		<column name="ca_fchevento" type="timestamp" />		
		<column name="ca_url" type="varchar" />
		<column name="ca_event" type="varchar" />
		<column name="ca_ipaddress" type="varchar" />
		<column name="ca_useragent" type="varchar" />
	
		<foreign-key foreignTable="control.tb_usuarios">
			<reference local="ca_login" foreign="ca_login"/>
		</foreign-key>	
	</table>
		
		
</database>